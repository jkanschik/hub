"use strict";angular.module("hubApp",["ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","hub.widgets"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}]).run(["$rootScope",function(a){var b=new EventSource("/rest/events");b.onmessage=function(b){var c=JSON.parse(b.data);a.$broadcast(c.topic,c.object)},b.onerror=function(a){console.error("Problem with connection to openhab event stream:",a)}}]),angular.module("hubApp").controller("MainCtrl",["$scope","widgets",function(a,b){a.widget=b}]),angular.module("hubApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("hubApp").constant("widgets",{label:"Start",widgets:[{type:"Group",label:"Wohnzimmer",widgets:[]},{type:"Group",label:"Schlafzimmer",widgets:[]},{type:"DateTime"},{type:"Weather",location:"Essen",thingUID:"yahooweather:weather:2c0d6cbf"},{type:"Weather",location:"Berlin",thingUID:"yahooweather:weather:berlin"}]}),angular.module("hub.rest",[]).factory("Items",["$resource",function(a){return a("rest/items/:name")}]).factory("Things",["$resource",function(a){return a("rest/things/:uid",{uid:"@uid"})}]),angular.module("hub.widgets",["hub.widgets.group","hub.widgets.dateTime","hub.widgets.weather"]),angular.module("hub.widgets").directive("hubWidget",function(){return{templateUrl:"widgets/widget.html",restrict:"E",scope:{widget:"="}}}),angular.module("hub.widgets.group",[]).config(["$routeProvider",function(a){a.when("/widgets/group/:id",{templateUrl:"widgets/group/groupContainer.html",controller:"GroupContainerCtrl"})}]),angular.module("hub.widgets").directive("hubGroupTile",function(){return{templateUrl:"widgets/group/groupTile.html",restrict:"E"}}),angular.module("hub.widgets.group").controller("GroupContainerCtrl",["$scope",function(a){a.items=[{},{}]}]),angular.module("hub.widgets.dateTime",[]),angular.module("hub.widgets.dateTime").controller("DateTimeTileCtrl",["$scope","$interval",function(a,b){function c(){a.currentDateTime=new Date}a.$on("smarthome/update/Sun_Elevation",function(b,c){a.sunElevation=c});var d;d=b(function(){c()},1e3),c()}]),angular.module("hub.widgets.dateTime").directive("hubDateTimeTile",["$interval",function(a){return{templateUrl:"widgets/dateTime/dateTimeTile.html",restrict:"E",link:function(b,c){function d(){b.currentDateTime=new Date}var e;c.on("$destroy",function(){a.cancel(e)}),e=a(function(){d()},1e3),d()}}}]),angular.module("hub.widgets.weather",["hub.rest"]),angular.module("hub.widgets.weather").controller("WeatherTileCtrl",["$scope","$q","Things","Items",function(a,b,c,d){a.thing=c.get({uid:a.widget.thingUID}).$promise.then(function(b){var c=_.groupBy(b.channels,"id");a.channelItems=_.mapValues(c,function(a){var b=a[0].linkedItems;return 1===b.length?d.get({name:b[0]}):void 0})})}]),angular.module("hubApp").filter("itemState",function(){return function(a){return a&&a.stateDescription&&a.stateDescription.pattern?sprintf(a.stateDescription.pattern,a.state):a}}),angular.module("hubApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/main.html",'<div class="row"> <hub-widget ng-repeat="widget in widget.widgets" widget="widget"></hub-widget> </div>')}]);